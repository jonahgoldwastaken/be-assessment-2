sudo: required
language: node_js
node_js:
- 8.9.4
notifications:
  email:
    on_failure: change
branches:
  only:
  - master
addons:
  apt:
    sources:
    - ubuntu-toolchain-r-test
    packages:
    - gcc-5
    - g++-5
before_script:
  - sudo unlink /usr/bin/gcc && sudo ln -s /usr/bin/gcc-5 /usr/bin/gcc

jobs:
  include:
    - stage: lint JS
      install:
      - yarn install
      script:
      - yarn lint
    - stage: build assets
      install:
      - yarn install
      script:
      - yarn build-prod
    - stage: deploy to captainduckduck
      env:
      - DEPLOY_HOST=https://captain.captain.jonahmeijers.nl
      - DEPLOY_NAME=date
      - DEPLOY_BRANCH=master
      install:
      - yarn global add captainduckduck
      script:
      - captainduckduck deploy -s -h $DEPLOY_HOST -a $DEPLOY_NAME -p $DEPLOY_PASS -b $DEPLOY_BRANCH